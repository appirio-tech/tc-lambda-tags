language: node_js
node_js:
- "4.3"
install:
- npm install
before_script:
  - chmod +x deploy.sh
script:
  - npm test
sudo: false
deploy:
- provider: script
  skip_cleanup: true
  script: ./deploy.sh
  on:
    branch: dev
- provider: script
  skip_cleanup: true
  script: ./deploy.sh
  on:
    branch: release
- provider: script
  skip_cleanup: true
  script: ./deploy.sh
  on:
    branch: master

env:
  matrix:
    - CXX=g++-4.8
  global:
    # DEV_TAGS_ES_HOST
    - secure: aKzR/mN7cnJakdXy55sc1P6x+pcv/+bOdfkHS6G3+d0S0S9D9iwliWacNVvcCUSMKGYdIVPNrm6vm2nl8ynA6nbqFExfkbMTx+G9LIO6RnfjPiPTt8Oe0uN3qnwSbrVlFRdJKH5HA+WDYLu/D+JvyJ4YLVOUa+DcxJ9Rh9M6oJFCRYObWQM1xQXUW0TzOP9FkFlUuGUC3oxbCDeqrXL6s7vJokbvp76vCiN3QGF04QhqiWzbWN2HVY271MT4xXA7YRgy0gcq8CnzPNmnsZQEL32BtyLQJIuUAZisTLHeECeoH7HD06Z/1oNKq/VH1kuys4rLaTxAQHkDsYH2XaSr0znVqZ1Nf3x+25uOQfdz4dZO0c6Xsv29Ujio69NSFZtODZOMBsqB9DKjvGn2YplNHVOGAQ+RorLjkzVQUp/1YiKXmWoyizKvEhZTR6L8kLFq1ByrODDNJViF4ejiArnqVaTjkKus+uaGSFsM9JeyCNLwzlxh5VnDDfBgCgjgE70MPQ0MLhlXrTA8pyim8z0o5xkocbbVNINfEAFQtQ76KOe+5uYfxaqdZq79yNzixwElTFeit1DPXkA9IYeNhtKeMd8uA+sMH90SbN8Sd6oU1WUGh0bzAuPc7a4+fxmxWo8zOkvvVO7wFyXaFvicc6+xSrIK3JZQczEI0++M+2XcXBM=

    # DEV_AWS_KEY
    - secure: BwUf0WljxuSU11iUhhff+BpZbFIsgHdr8wVEzsUjdgrMVyNjh5bSOjbDWXKV9b+9ZOONd2retgBD1JAdCkmEnaZczR9GvcBgQFSHKUHcNQZc2FwzjZcVeWK0Jeo9ga1UUi8UttEIZJ60LXatOp+a9hkSWxJcvGAt8VhA1oPFvwtdoqoe3BkQ6CNqkjLHfTGBj66PbMKOLVautK1BVAOcwA0jHr8R9Ge4sMtLl6YhGiZcdNqexN/Wpbg7b/lLyJbb3LV3teIQ1M0HuRujLmiD23vW9oLdbtSXuL+SZGQuMf8Mu+X+7OdONV+l/64i1OHDLtjbtw/b6mRElROYpaTn/Az6S3t9Jj3Y2PJWeT/rrlwL8XUOT6nBlfydBpHoa5NJNeIF0HvkE0g9XYxCLF3xhst3eUYQYtht/vn4MxOYYFBN83Pn2vyfv79N6JZjDRCwTmiVHgdCyPQvHii3pyknD7WPRpKJ2GcP503zp0swouZwd0RdLL70vnJWD+Cig97buHGXu1+tefDmS4Rzfa7vRSnSuuIgN3VPScJ7K1eKmGtN87v69Nxcdy3Oy3YV94mu+xpL/MUNvNKpdAvliLn37B5Cq+yU99hEdwewQe0Bz3LFG3AyXOJx15nAIkCC1u7xBOycdwGBSQE4oL7/Sg5Jdx6oB3EpTO2INXw/vlN/cuQ=
    # DEV_AWS_SECRET
    - secure: dbPLpXEaY278eWfm3yrHzmj2y2iD6CgYud3xDMjVDoyXcFOzk8ib+AYIkNp2g+y+lnI0QRn2A/fk9Vln4/XJ7gbNY+n7u9tYEQUXf4/DfJMkXwgi1ORG2e2yxH+nanJaKDXXEtfEw7nosDzscXVSJsh1doB7vEAViZl14Ri+61/9nKuGUSU8li7cgPZPvDNIUgfTvaLDA/qLiSronmf4pFu8PTmFpII+XV7GoJdS11TYahXQOmT+7Xgg8RSu9jpNQAFFN6WordH7hUz0068msEfYUF9RUXpgelNzRZCEG2vOyMXTr3+CEiv1lV9IOZeusQrjOnlGsIyiFn8Mt5XEr0J5lSNsDooiLW4fj06shUFlvPHuWalF+gVr1sw6luq3EZP7ky/WtlX7R/fdo7UhkaaxNbdpRBY4K15gesjUVYyz/3/liMvJ3cU+g/OFniKrsr7pWOvHgJ422iRUhmWOi86rZbEUU/iDBVQvbgyOF9MkQaGL/gqUc3Z47tGC4s2aI8eMw4GLpgCEVVJW54u67obD7rhecCQOdw36fPHYwJ9lJNju3yYGGXduNgk7H27A0V9Fu54wq1IlCRh7PndL7A8cOrSaLlNisAwqYaZZeXo0zBqzCgt1cdWSgVTT1J4XQCD3Vx9ICmj0fc2QmrqOrT4L8dsY78oBPkwpRAvaOtw=
    # DEV_AWS_LAMBDA_ROLE_ARN
    - secure: iWq4wjMC+xlsnTtJWrbmA9DHcWjuN8D97tiJWq2iV8tUS2mMyw/08c9l/YSapsdiAeGx4c7+IkGUf3ZDbhPYO/FP/m1a8VCQ93sti18jVk1Zn4HU0b5cMc7AfPbTAXgZxjMRfV8fDLxTUxWk1pSzXtxd1kNoKuxGu99AvHbbwgy8neO8umoX1qzKUdHFF/FXKwZmqzpQVe0kgDIP63ia8nmMxGftqk2n9YxjSTm0T+vv6ZxDytkbDpwTaFuemQ9Lg/2+PUqUX6QnuSL2urGDFEh+l2ycJkRFAyuK9Bsgv975QMX1kWq8nRk9qIQ0UIYiNFrPHZaHC810JHR6TZ868+D1lE9okYfJyQ65LP69niXOH596Hv88fqEaye1ozi6J3XZU7ABRRtvGKLoXUBs4Gv+j4ijDUSaKaBciDMsmhuRO5xTuuatv9fbC0leLbyrRFCmcmPuYFiQOXp6dj5mvXNm4SozC9cQmnQ6aKKOzB+f3/CmnVAKKrhg3RiT6xFvsBhiWxeyr27XvUb+ptB/G43zuY4GXQQBfKt2MjlNh+6cXr24js/nETrY1eYjghdXBhbBMQ90OhSd8m4zNuQZPwc2ZwNoAKFnb2e2DM/2f+OSoN8ob4K9q2Tc7/ryhNOrvApwHWrVu6mVeh2lO2wSEJjm+7n7yMksKf7n6W9pHrcU=

    # QA_TAGS_ES_HOST
    - secure: oeL2PPgEyfkit5iVQCOz8z8eUHhGY9C2Zl47pH7MKfCTlWs7tlXu6umFuh2ocvMLoeXVYLABAjA8IprC0QLHT157253s5sjs5ghY1yCQoELl6SjzbM4LW9J9Gc3BuZUrZn+vkhed5EWMNt6/1RKnvfKh5pFTrMlC/x90op1mk54SjEnSDHKVSr5yIY1s34AOww8JjpezGKaLb6XKjX4IsMFoQmoqhqPXR5rcqO3cmK7UET4mcZiZf84jfW+ikGh/EN7Ab20yTviIUZI+KXuzLxTsR977J54/DhCF0D00Jyoz7p7SvphOHwYHQaPwVqMsT4NyO4F3//pG3mZCTCr8Bk1ZrAH3xHa+3bxE1+yIdzSBLTvlUR4m6kRxZHf1Yrlc3AOARi3/IpZtL9T9BXn73az/2DjyK5IoHoQfarn/+5eo5dO364QtZnEjStUbX56iN5te5Ir493x5M/Bg8ZELrobf8VGRzr3h7t4sx/yhuZi3a+wFCgmA7atY78+J5oFL7R85AgCkj0RZJ6WC/Pqpp+bm0Nu0uD0QfZGJji0OaQrWyz26jr8TqBSCthTlBt3yViFl5EJZu3Ke1bIc9v6X5RD8ukBmQmHoNkULNAyoOqJLzI4XYyTiga02f2a4AmfsmrjcuA2qFk5zoaMI8R03ftC+lppcERXXRpvEGDneRs0=
    
    # QA_AWS_KEY
    - secure: qSNrDf8WEzQNOPWYPCGf/gwbSzA7Wb8rf7Us7XohLXXbLWgQNPUVu0bmmwkjOnqt03t3gZKI4Fdl11w8zh9FHzvs1sITip/RW/VIN6Sc22Zfi7Ca2Hnd0pLxC9lsoioauxgkFN9ba2ycscwwMn7bYmXAJSIZJQB0NRdCC8E2XSEKgD64GMfxZpape8wdf+Uu9hHH92i+15s2vqNDtTMRmmYlH1th2r+n2T04BZHFKCmGw0dqKFPi3ix+pVrtBhC9EQg7ixIt4CqlcJ6EE4tQJbIXBrqaC4acgpnGnMAHkOmCl5sf37CRmMpUhSoJCd4UhvAAOf57ids5x7oq9+/Ff4FhOJZfE/hI0jtZB3xYmqwD7sz8a9/1vu+/MV3Oog9B1ecssegJfvX+lvgOnxfA0ixmcq/6amN5qrVuVDi3nrySeeQfc15s5pcc9INhUV5AR3k9YjJOh48e9Mfbn+BxiHnx48nRuU+e3e7OzHTN+6Zy7GCtVCUTuJ/9tYF32ZqllfpbCt+/7i9QvdUEnGfpPK4wRyKjeyx6HRiLHaU6vbFXiKrfbwYQpJ0N7XcpB+W0LKuwcZ6cQlkOVX2k9uoJ1PWKaxrzyRVXr7kxi/Qve9Bz8DmHoECgMTyLJ2ZauUOqk2+EpB3vj/wG0sUbIsB/lY4cpDg7gPVWXQ9Zmju0gQ8=

    # QA_AWS_SECRET
    - secure: BpCi1S1XT8U2QLh8+cqH8ZZdPOz+pqqebHvdN6l0sGOsTKDR0OsleJlsENgqBozG71L0n3lqc9MZW/wtmr6DUhqj6OH+HqGePw6FSqxDvGnUK8Z8SqVadt5FpmH/sD97viergt3FX5A+5JkcgXkZoscOa/Rn8jo1DreCHKEVqGq2LW9saOG+mk8vO3sewetkHFaptFbyvlXbhzsNqSfVBylyw1L3UQ2WiGf8JzQ4oOu7fKNwhWlos0pt009O7fUjxcP+/E2d+puoIs/j6q6AEKo92Na6FDs2PnJ6sruAlC/9qbzeraE85B79PGTzKYo5lgorh2LioLZZaNDFoIUUxg46I8IEl7EufpqCDGFMEDqp8PP0tT1Z5O34a5m3pTLa1bDLZaum2JU6lM/1LLnYS4T3gsh6HnOFHxBP9sB2pL+gaOcJgTbgBokxgXEss7qyX0a1t6NRmEUrst8DXJ56zhI+TpTFCmPhjlqxZWQtTaHKBNGibznF+hwUDkTM0uLmBv8A8/OxbGR/jUEo6hjUU2YeaAAiHun5EXno00sUiXBsoh6x+lGP5HvGRyFdTKqkaKuyu2RJv1TmxVvQSTxgxPu74061cCE+L2UzVdT0Iyb1AeEjY/Xz18aNFsHflA9bIDMNwE3//sIa6rDOoWPF5h3t6QpzfY4nWdFirCMY7+8=
    # QA_AWS_LAMBDA_ROLE_ARN
    - secure: eptPNgicVBQa+O3t+65Hd2G6PxrrgkyhuVx/w1xU15MTvsg7VQ5Jx14TckonaW75w0VOOv4qdABoq2vqEhgu3Pf7VeaHV43NdtAeCWcJzjPnJYayDHCV9r9kDNt0m8/WEpCuqPXX7fNes96pQE8HKPE4t4g65jc25Awj0v9ZLk+Jru4efgSQWEBp65b4iS8sHADgdCNTpn+T8sARj8Yg63+jtJghVlHOfBm8xwMy/A52tRWD3E6is/QtjBRxFu7cAnlq0waLlC7uhx4XNZP7tAzm90w9zyxJyaj88XaLPIwdZp8kA9VsPHMRTFx4PFmWwraaHzrnWctETHfAV+KcIlvGDhwMg7fCAAS69ibiU2NYjnEvhC99y4qtf3oLQhDbi2NwU19shhIi31lZ99acN05grVtpLNfe7STidRXYvN8bzWZsjjrgkj/58vWeXGGJcoL6dE3Bejde1Y7L5+1Fus1z0OI2aO8zHLUa1Cw7zbkOLFg6f80O3WDFbnQtBld0b2pbuIzb9yVQ8EBRCQISD5o0QhRycLOE8GQbhUl3MDRpWxhLdEGQyjPAGAOrMJveCXwJFeSh2XK9p4jQR9xbXsidq4sfDjFULWthSWLaJ/mg4KTOjh7j/3pmfKwU7RCSpuUoqpTcN/asen5UzJerskLdSFuhuPmptN6GGFuTrWk=
    

    #PROD_AWS_KEY
    - secure: YNvpxfTJOEX7acFaFf7v1FzabYy41532KxAx8KTHSrS34gklWcAsz0HAwFjZjxdCjQyCmuYHwBlTQZisetn4htelL1U5KA6jaGrmpeZmmirdZ8ZRNLVRRRvkc/oILP5d0eHhzTl8wzQTyo3g7fPOQ/CLRGNiK8GksVqL8Ab/kIh8L+1KVyF2fesy2S3zKQJRJwudMrvKT3BrEyRt/jCySbuW6yGVtwYOtsyysNEOpEw+nQz0tZMk+4MRo66cG7wmItekWmhIUO/y6ppqbWwHBjtiMVgqtnjI3BsRzfYrK4WnU/L9OTqJ9leraR5o2bDRI04zPTiGDYBdpHD2zABEWc/wFUku75bynwHe2OJtkd5VpujdMnW4ZymvKUhHFhZgouZMUhgfg/y635ITg6xODcu9z1O6a88lGdaD91zD2pxIroVN15W6dFToAwpZVODcAZVuIfludobqktZRkfkDl7VloN1V1XFIjpmruUJCYxmzfY2II9qWacawdJfFo193IIcbimKng7+/cfvB9665FoulWgjqHOcuXz8c5oHKq+lo7AaGwVPbDQoer/jcVI83eI8EruzUfp9eItqITGhak1ROm65nV/jnCe/UbUrvpu6vhxtB2FBpr92ELUGQZweSUn7EERnNBhwLCwnkphM4a3lP58Jou5skddXfhWUSeo8=

    # PROD_AWS_SECRET
    - secure: ULPjE9fID8xFs0tgA0TCbZFDDO1wIHVIdnR/csEtOA/69e9Pxy88k+sdXhwNHTy8uFDrysyrG2WgJciYRH3p6PGtoMWOaW0knhvctgAVrPTlSrfDcbS6RLH45pKc1M70KeOh9m1J9vQgjZ2JOLmxhZZeyEbCqAnLemMaWGsI0QQk/hwqoVaxLfhMGPQSWGEFnjOdBhhy8nKpsSNAVv+S7afGAGWV+rWJNR8BXCHF/ewOL+WEfgjExZFQYFy9nTfs0BhlaLTXjlLTrGJhbA7JuO80Bzj5BlyHrncQHiKJfyzeBFbOIVHpGXH8cGhwumoNQt3oKyZzshx8RLqtV+XM71ddKPF3jbF4Q3llKS5etzfpqkoEJjcuAkapeKYESxZFAMHMfqVTXjpbraIEyClFJk0COMB1fLSLLFNxrj3ZzhbAVrSvLt1TIQ74SawJegp8Wnu21lNDjUX7Bb8pCAV6pOSfY8c0uGV8QTDVR52lW4XkcIPO+ExwDJXKGiyrBYW2u2I5secUnRXBHRQDrNOQ3ijcZNUF29J/bGcGd11oZF3QApGqd6Uhwrfu+UHT/lFu4D0H95pSzqqJnX6/3oMQvd7BzVPbUvOW/RsfZ9JIboFCybmQC2b//JtS19VunnpLxnMqIF7PphaCUaQXD9lYjgMBktpvrrjGPK65mCI4F6Y=

    # PROD_AWS_LAMBDA_ROLE_ARN
    - secure: VVfUv4Le8KNZu4fsieAFgW8E4xhZxbj3hJQ933IpDkflEOOSjLSzQUvcP9KJpEbVQGtMgnm0gq+RH5w8QI9PlrOrR6qZEfBGdeyMsF9OcTCGw1+TVrtiEPMGn8wIVNr+saaJcaJ/CwFtwsc/ZPpnoeorzepEv7WNjOT5d/KPj4xIu8xkfWR+m4Sy+P/2FFjyXvkbF6sjAK1D3Lra3FDrx2Q9oykUIN9Wr8Kqxkov96EaA+uP3xagTY/zwfWBsqyaTXpi1saqzd2OtucPsguQT80jJ+Z3EXr2+T96Z1nkruHjXN9eFrb4l5qorpYn3F26yFOr+B9hrFNFnBJz1Lj1hqUwJO/XdRenThR/ZPsO000vLU+SqBqHSTd50bPPnMJ9bp7BfOgl/g+4vOCTivXe9UdCs5MdXlmc1ZncDPmrFfgRxZliwo09UJKJL0/UoqMqdkefao7JGXxZaF/hMiTXilYfxdR6gxS/sMyTr1krGL4Ico4n2m3uC8zurGlUdiJjW/KXi5N5szD6oDSz0OJBoozj9DxJgvGJwdDa8OPLp3U8lXqpvW/XfLDUrRynsfp08LgiLxc/R654QzfwPwys/ebg2tGo2UL8hLoVGUCE0ugV7jWTXxoZjjkg/7uRMraUVlRx2JcQOJcJAosbYu8Ca9uemc8UItiZIAcI0xmAvGA=

    # PROD_TAGS_ES_HOST
    - secure: gP2yC1zRdVaTNrWLJv8dX+n4AR6qYb7ADyBx2kztWMo/ccMTAMUQosryTRAIPWnp4TNBBKENjjngnV7GDSedAyDm5na4Uy+g8PwP3hcXiu5sBgajyv1XlEFbGhI1ISJQDa/ydK4XhURIxi6TFk7WGd5c/h4slCljqbQ80UoYYcZ/3ccQ0FgFirjPN6jOYZpLZD8AgNgdgTE9G58GE3gvlI/gp32KXkGNcncXP5Ju1v2K/kTjl8oyPgChBD2reQySUNbMmyf8rpCxKHRjI3JyQsouUUQvM0KBY1ZrZEpA/aWZLWhedkQhlE7jILSJek2HnWiTb9mqYhOiJqCWLHPEM3gtQ1VYoMJiGA0s84lqIfm+9UdE/MDC3Vvub7+ulyy2FryyELM3u7Gm8uMsViEERdEd6dGy0cr6A5jqDa06/ueGpb3NhgGM/0rxPtnrxvWb9dEikOWW24pD3O62+dm9JiJ8G8k1hRhycf+RaX3nq79/kpmr/9zxty6gYuqsdYTntKdH2gDLIW/KuYPXum6egkq1hDM09rNUDaZjEkhimWN5x4/wOUqSuro7melEL/N0QC4rzYf0SyC1YxLPRnETO7nxkK1mA69YXEJql4v4YpdPNlFQlx9dDCzDAOAJ79s8f+TF/nXC6Sgs0En1swHfFVzYL2O9ibH0RZejEQ1urUI=

notifications:
  slack:
    secure: PMGlpdBoRzMlIjCsPWdXJ1wf550b+mpX0x44ggGWNL7ErpNebfyqIbXf4VJXYQDmhVJt31ygDaxTtj8XwZJlbvQjE6WGHU26KvL/efGJJL5EmgFD8LDBFpsbn49PyoZuVOTbSzqP8d8WCCPo4oBvX2r2Q2Ixh/tUx7i4Bcv0XwNpWAR75v1Yq/NftEI48k2GcI3oHqmuEgLHdP93k1rCUM4sBsgkr4PCltZfoE2AWlF6wY59w/oFiKj4FwycY8QjJZa/zbSQq1B/9QD7n4YBY4QjVv3LmjshEiQv1HGo2rNLV+/BB5ZoQ6JEH9h+seduHNTF+mkToKbJ2YjDERLlqLFYWVQKXTqFkSdYuknguJ3uOfXFaGtPDSqTRljE6WW6UDIJi9lDpxFHjH2q848/2O03RKtYeFKJWNbVb7Q2PWTBFxx6OurYra+tbUAorQiYmAQxd0vJY+qzGIDJZIQ8yDE4C10heOhfRyU8wJSKF3xJUKKWVGfBuHivFBZOETFSg0uVBcJnsXRcErvEQz0LuKaZfP81bIokcKUGxum/xyp9mYhYqWDvIj31RUhDMiRxXTPe9PhW0mlOtRG7tm2+8G08exHPSfONSV2IPUtlQt4j2/+I22ncOwtsm6yZzXXbDjoMR2sCHIyJj3lVECOqAnCfNJ6Q0CNJ93LqxKSHdFU=



